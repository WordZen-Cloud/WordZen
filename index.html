<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>WordZen Online</title>
    <link rel="manifest" href="manifest.json">
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <style>
        :root { --neon-blue: #00d4ff; --neon-green: #00ff88; --neon-red: #ff3e3e; --neon-gold: #ffd700; }
        body { margin: 0; background: #000; color: #fff; font-family: 'Segoe UI', sans-serif; overflow: hidden; display: flex; flex-direction: column; align-items: center; height: 100vh; }
        
        /* Arka Plan */
        #bg { position: fixed; inset: 0; background-position: center; background-size: cover; opacity: 0.5; z-index: -1; transition: background 1.5s ease-in-out; }

        /* BÃ¼yÃ¼yen YazÄ± Splash EkranÄ± */
        #splash { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; justify-content: center; align-items: center; }
        .zoom-text { font-size: 1.5rem; color: #fff; letter-spacing: 5px; font-weight: bold; text-transform: uppercase; animation: zoomInZen 2.5s ease-out forwards; }
        @keyframes zoomInZen {
            0% { transform: scale(0.5); opacity: 0; letter-spacing: 2px; }
            40% { opacity: 1; }
            100% { transform: scale(2.5); opacity: 0; letter-spacing: 25px; }
        }

        /* MenÃ¼ler ve Butonlar */
        #menu-screen, #lobby-screen, #game-screen { position: fixed; inset: 0; display: none; flex-direction: column; align-items: center; justify-content: center; background: rgba(0,0,0,0.3); }
        .btn { width: 260px; padding: 18px; margin: 10px; border: 2px solid var(--neon-blue); border-radius: 20px; background: rgba(0,0,0,0.7); color: #fff; font-weight: bold; cursor: pointer; transition: 0.3s; font-size: 1rem; letter-spacing: 2px; }
        .btn:active { transform: scale(0.95); background: var(--neon-blue); color: #000; }

        /* Oyun KutularÄ± */
        .letter-box { width: 38px; height: 50px; border: 2px solid rgba(255,255,255,0.4); margin: 5px; display: inline-flex; align-items: center; justify-content: center; font-size: 1.8rem; font-weight: bold; border-radius: 10px; background: rgba(0,0,0,0.6); }
        .correct { border-color: var(--neon-green); color: var(--neon-green); text-shadow: 0 0 10px var(--neon-green); }

        /* Rakip ve Alt Bilgi */
        #rival-ui { width: 80%; margin-bottom: 30px; }
        .prog-bg { width: 100%; height: 10px; background: #222; border-radius: 5px; overflow: hidden; border: 1px solid #444; }
        #rival-fill { width: 0%; height: 100%; background: var(--neon-red); transition: 0.4s; }
        input { padding:15px; border-radius:10px; text-align:center; background:#111; color:white; border:1px solid var(--neon-blue); margin-bottom:10px; font-size:1.2rem; }
    </style>
</head>
<body onclick="startMusic()">

<div id="bg"></div>
<audio id="bg-music" loop src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"></audio>

<div id="splash"><div class="zoom-text">WordZen</div></div>

<div id="menu-screen">
    <h1 style="font-size:3.5rem; color:var(--neon-blue); margin-bottom:40px; text-shadow: 0 0 15px var(--neon-blue);">WordZen</h1>
    <button class="btn" onclick="initMode('normal')">TEK OYUNCU</button>
    <button class="btn" style="border-color:var(--neon-gold); color:var(--neon-gold);" onclick="showLobby()">1v1 ONLINE</button>
</div>

<div id="lobby-screen">
    <div id="lobby-init">
        <button class="btn" onclick="createRoom()">ODA KUR</button>
        <p>veya</p>
        <input type="text" id="join-input" placeholder="ODA KODU">
        <button class="btn" style="border-color:var(--neon-gold);" onclick="joinRoom()">ODAYA KATIL</button>
    </div>
    <div id="lobby-wait" style="display:none;">
        <p>ODA KODUN:</p>
        <h1 id="room-display" style="color:var(--neon-gold); font-size:3.5rem; letter-spacing:10px;">----</h1>
        <p id="room-status">ArkadaÅŸÄ±nÄ± bekliyoruz...</p>
        <button id="start-btn" class="btn" style="display:none; border-color:var(--neon-green); color:var(--neon-green);" onclick="triggerStart()">BAÅžLAT</button>
    </div>
</div>

<div id="game-screen">
    <div id="rival-ui" style="display:none;">
        <div style="font-size:0.8rem; color:var(--neon-red); margin-bottom:5px;">RAKÄ°P DURUMU</div>
        <div class="prog-bg"><div id="rival-fill"></div></div>
    </div>
    <div style="margin-bottom:20px; font-size:1.2rem;">ðŸª™ <span id="coin-txt">20</span> | Seviye: <span id="lvl-txt">1</span></div>
    <div id="word-area"></div>
    <div id="meaning" style="margin-top:25px; color:var(--neon-green); text-align:center; padding:0 20px;"></div>
    <button id="next-btn" class="btn" style="display:none; border-color:var(--neon-green);" onclick="nextLevel()">SONRAKÄ° SEVÄ°YE</button>
    <input type="text" id="hidden-input" style="opacity:0; position:absolute;" autocomplete="off">
</div>

<script>
    // Firebase AyarlarÄ±
    const firebaseConfig = {
        apiKey: "AIzaSyD-iT8DyWapzSChkUtVHFytZVSS5Ec9HaA",
        authDomain: "wordzen-d82f1.firebaseapp.com",
        databaseURL: "https://wordzen-d82f1-default-rtdb.firebaseio.com",
        projectId: "wordzen-d82f1",
        storageBucket: "wordzen-d82f1.firebasestorage.app",
        messagingSenderId: "631323474078",
        appId: "1:631323474078:web:198ce56d58bd11d842e38f"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // DoÄŸa Arka PlanlarÄ± (10 seviyede bir)
    const bgImages = [
        'https://images.unsplash.com/photo-1448375240586-882707db888b?w=1200', // Orman
        'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=1200', // Deniz
        'https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=1200', // DaÄŸ
        'https://images.unsplash.com/photo-1501179691627-eeaa65ea017c?w=1200', // GÃ¼n BatÄ±mÄ±
        'https://images.unsplash.com/photo-1436891620584-47fd96566be4?w=1200'  // YÄ±ldÄ±zlar
    ];

    const library = [
        {a:"ELMA", m:"KÄ±rmÄ±zÄ± veya yeÅŸil renkli meyve."},
        {a:"DENÄ°Z", m:"Tuzlu bÃ¼yÃ¼k su kÃ¼tlesi."},
        {a:"ORMAN", m:"AÄŸaÃ§larla kaplÄ± geniÅŸ alan."},
        {a:"GÃœNEÅž", m:"SÄ±cak Ä±ÅŸÄ±k kaynaÄŸÄ±mÄ±z."}, 
{a: "PANDA", m: "bÃ¼yÃ¼k, siyah beyaz ayÄ± tÃ¼rÃ¼."},
{a: "KUMANDA", m: "cihazlarÄ± uzaktan kontrol etme aracÄ±."},
{a: "Ã‡AMAÅžIR", m: "yÄ±kanacak giysi veya kumaÅŸ."},
{a: "MERMER", m: "yapÄ±larda kullanÄ±lan taÅŸ tÃ¼rÃ¼."},
{a: "BALÄ°NA", m: "bÃ¼yÃ¼k deniz memelisi."},
{a: "JAPONYA", m: "asya kÄ±tasÄ±nda ada Ã¼lkesi."},
{a: "ZÄ°NCÄ°R", m: "birbirine baÄŸlÄ± halka dizisi."},
{a: "DÄ°NOZOR", m: "Ã§ok eski Ã§aÄŸlarda yaÅŸamÄ±ÅŸ dev hayvan."},
{a: "FOSFOR", m: "Ä±ÅŸÄ±k saÃ§an kimyasal madde."},
{a: "BÄ°SÄ°KLET", m: "iki tekerlekli ulaÅŸÄ±m aracÄ±."},
{a: "KONSER", m: "mÃ¼zik etkinliÄŸi."},
{a: "SARDALYE", m: "denizde yaÅŸayan kÃ¼Ã§Ã¼k balÄ±k."},
{a: "MANYETÄ°K", m: "Ã§eken veya iten Ã¶zelliÄŸe sahip."},
{a: "YELKENCÄ°", m: "yelkenli ile gezen kiÅŸi."},
{a: "MORAL", m: "ruhsal durum ve motivasyon."},
{a: "ÅžAMPUAN", m: "saÃ§ temizleme Ã¼rÃ¼nÃ¼."},
{a: "KAFES", m: "hayvanlarÄ± sÄ±nÄ±rlamak iÃ§in yapÄ±lan yapÄ±."},
{a: "TURUNCU", m: "renk tÃ¼rÃ¼."},
{a: "PALET", m: "taÅŸÄ±ma veya resim yapma aracÄ±."},
{a: "Ã‡Ä°KOLATA", m: "tatlÄ± ve kakao iÃ§erikli yiyecek."},
{a: "MUM", m: "Ä±ÅŸÄ±k veren balmumu aracÄ±."},
{a: "PAPATYA", m: "beyaz yapraklÄ± Ã§iÃ§ek."},
{a: "KÃœRE", m: "yuvarlak cisim."},
{a: "Ä°PLÄ°K", m: "dokuma veya dikiÅŸ iÃ§in kullanÄ±lan ip."},
{a: "RADYO", m: "ses ile bilgi veya mÃ¼zik veren cihaz."},
{a: "KÃ–RÃœK", m: "ateÅŸi gÃ¼Ã§lendiren araÃ§."},
{a: "TÄ°YATRO", m: "sahne Ã¼zerinde gÃ¶steri yapÄ±lan yer."},
{a: "KREM", m: "cilt iÃ§in hazÄ±rlanan karÄ±ÅŸÄ±m."},
{a: "ÅžEMSÄ°YE", m: "yaÄŸmurdan veya gÃ¼neÅŸten koruyan araÃ§."},
{a: "FÄ°LM", m: "gÃ¶rÃ¼ntÃ¼ ve sesle hikaye anlatÄ±mÄ±."},
{a: "Ã–RDEK", m: "suda yaÅŸayan kuÅŸ tÃ¼rÃ¼."},
{a: "SANDALYE", m: "oturmak iÃ§in kullanÄ±lan mobilya."},
{a: "FÄ°YONK", m: "giysi veya eÅŸya sÃ¼sleme aracÄ±."},
{a: "MAYO", m: "yÃ¼zmede giyilen giysi."},
{a: "KAPÄ°TAL", m: "ekonomi ve sermaye terimi."},
{a: "Ã‡ATAL", m: "yemek yerken kullanÄ±lan araÃ§."},
{a: "KAKTÃœS", m: "suda yaÅŸamaya uygun bitki tÃ¼rÃ¼."},
{a: "PÄ°ANO", m: "tuÅŸlu mÃ¼zik aleti."},
{a: "KOLYE", m: "boyuna takÄ±lan sÃ¼s eÅŸyasÄ±."},
{a: "ÅžAL", m: "boyna sarÄ±lan giysi."},
{a: "BÄ°SÄ°KLETÃ‡Ä°", m: "bisiklet kullanan kiÅŸi."},
{a: "AVOKADO", m: "yeÅŸil meyve tÃ¼rÃ¼."},
{a: "KALEMTRAÅž", m: "kalem uÃ§larÄ±nÄ± aÃ§maya yarayan araÃ§."},
{a: "KONUT", m: "yaÅŸanÄ±lan yapÄ±."},
{a: "YANGIN", m: "kontrolsÃ¼z ateÅŸ durumu."},
{a: "TAVÅžAN", m: "kemirgen hayvan."},
{a: "MAYMUN", m: "memeli hayvan tÃ¼rÃ¼."},
{a: "Ã‡EKÄ°Ã‡", m: "Ã§ivi Ã§akmak iÃ§in kullanÄ±lan alet."},
{a: "PATEN", m: "tekerlekli ayakkabÄ± ile kayma aracÄ±."},
{a: "MÄ°NÄ°BÃœS", m: "kÃ¼Ã§Ã¼k toplu taÅŸÄ±ma aracÄ±."},
{a: "KÃœLAH", m: "dondurma veya baÅŸa takÄ±lan giysi."},
{a: "BÄ°RLÄ°K", m: "bir araya gelme durumu."},
{a: "KAZ", m: "suda yaÅŸayan kuÅŸ tÃ¼rÃ¼."},
{a: "KAVANOZ", m: "yiyecek saklama kabÄ±."},
{a: "MÄ°NARE", m: "camilerin kule benzeri yapÄ±sÄ±."},
{a: "SÄ°LAH", m: "savunma veya saldÄ±rÄ± aracÄ±."},
{a: "ÅžAM", m: "mum tÃ¼rÃ¼."},
{a: "Ä°STASYON", m: "taÅŸÄ±tlarÄ±n durduÄŸu yer."},
{a: "FENERBOL", m: "hayali oyun veya spor adÄ±."},
{a: "KUÅžE", m: "parlak kaplÄ± kaÄŸÄ±t tÃ¼rÃ¼."},
{a: "BAKIR", m: "kÄ±rmÄ±zÄ±msÄ± metal."},
{a: "BÃœYÃœCÃœ", m: "sihir yapan kiÅŸi."},
{a: "Ã‡Ã–REK", m: "hamurdan yapÄ±lan yiyecek."},
{a: "TÃœP", m: "gaz veya sÄ±vÄ± saklama kabÄ±."},
{a: "KUMPAS", m: "Ã§izim veya Ã¶lÃ§Ã¼m aracÄ±."},
{a: "PERDE", m: "Ä±ÅŸÄ±k veya gÃ¶rÃ¼ÅŸÃ¼ engelleyen giysi veya eÅŸya."},
{a: "TOPRAK", m: "bitkilerin yetiÅŸtiÄŸi katman."},
{a: "KURABÄ°YE", m: "tatlÄ± hamur yiyeceÄŸi."},
{a: "TEKERLEK", m: "taÅŸÄ±tlarda kullanÄ±lan yuvarlak parÃ§a."},
{a: "SALON", m: "oturma veya etkinlik odasÄ±."},
{a: "HAVLU", m: "kurulama iÃ§in kullanÄ±lan bez."},
{a: "Ä°LAÃ‡", m: "hastalÄ±k iÃ§in kullanÄ±lan madde."},
{a: "KÃœPE", m: "kÃ¼pe veya kulak sÃ¼sÃ¼."},
{a: "BLOKNOT", m: "yazÄ± yazma defteri."},
{a: "KASE", m: "yiyecek veya iÃ§ecek konulan kap."},
{a: "SÃ–ZLÃœK", m: "kelimelerin anlamlarÄ±nÄ± gÃ¶steren kitap."},
{a: "TAVLA", m: "masa oyunu tÃ¼rÃ¼."},
{a: "BALIKÃ‡I", m: "balÄ±k avlayan kiÅŸi."},
{a: "Ã‡Ã–L", m: "az yaÄŸÄ±ÅŸ alan kurak alan."},
{a: "TELEFERÄ°K", m: "ip Ã¼zerinde hareket eden araÃ§."},
{a: "Ã‡ERÃ‡EVE", m: "resim veya fotoÄŸrafÄ± Ã§evreleyen yapÄ±."},
{a: "YELKEN", m: "rÃ¼zgarla ilerleyen taÅŸÄ±t parÃ§asÄ±."},
{a: "LÄ°MONATA", m: "limonla yapÄ±lan iÃ§ecek."},
{a: "MANYON", m: "kÃ¼Ã§Ã¼k araÃ§ parÃ§asÄ±."},
{a: "PÄ°RE", m: "kÃ¼Ã§Ã¼k kan emici bÃ¶cek."},
{a: "KÄ°RAZ", m: "tatlÄ± kÄ±rmÄ±zÄ± meyve."},
{a: "BÄ°SÄ°KLET", m: "iki tekerlekli ulaÅŸÄ±m aracÄ±."}
 (ilk 100â€™den sonra tamamen yeni ve karÄ±ÅŸÄ±k):
{a: "AKVARYUM", m: "iÃ§inde su ve balÄ±klarÄ±n yaÅŸadÄ±ÄŸÄ± kap."},
{a: "BÄ°BERÄ°YE", m: "kokulu bitki."},
{a: "CÄ°VCÄ°V", m: "yeni doÄŸmuÅŸ tavuk."},
{a: "DONDURMA", m: "soÄŸuk tatlÄ± yiyecek."},
{a: "ELDÄ°VEN", m: "eli koruyan giysi."},
{a: "FÄ°YAT", m: "bir ÅŸeyin deÄŸeri."},
{a: "GAZLAMA", m: "ince hamurla yapÄ±lan yiyecek."},
{a: "HARBÄ°YE", m: "askeri okul."},
{a: "ISITICI", m: "sÄ±caklÄ±k veren cihaz."},
{a: "Ä°PLÄ°KÃ‡Ä°", m: "iplik Ã¼reten veya satan kiÅŸi."},
{a: "JOKER", m: "oyunda Ã¶zel kart veya karakter."},
{a: "KARPUZ", m: "bÃ¼yÃ¼k Ã§ekirdekli meyve."},
{a: "LÄ°MON", m: "ekÅŸi meyve."},
{a: "MANDALÄ°NA", m: "tatlÄ± ve turuncu meyve."},
{a: "NANE", m: "kokulu bitki."},
{a: "OCAK", m: "yemek piÅŸirme aracÄ±."},
{a: "PÄ°ÅžÄ°RME", m: "yemek yapma iÅŸlemi."},
{a: "RANDEVU", m: "Ã¶nceden belirlenmiÅŸ gÃ¶rÃ¼ÅŸme."},
{a: "SALON", m: "oturma veya etkinlik odasÄ±."},
{a: "TAVUK", m: "kÃ¼mes hayvanÄ±."},
{a: "ÃœZÃœM", m: "kÃ¼Ã§Ã¼k yuvarlak meyve."},
{a: "VÄ°TRÄ°N", m: "sergi veya satÄ±ÅŸ iÃ§in camlÄ± yer."},
{a: "YELKENCÄ°", m: "yelkenli ile gezen kiÅŸi."},
{a: "ZAR", m: "oyun iÃ§in kullanÄ±lan kÃ¼Ã§Ã¼k kÃ¼p."},
{a: "AFÄ°Åž", m: "duvara asÄ±lan ilan veya resim."},
{a: "BANDANA", m: "baÅŸa veya boyna takÄ±lan giysi."},
{a: "Ã‡Ä°NKO", m: "metallerden biri."},
{a: "DÄ°VAN", m: "oturma mobilyasÄ±."},
{a: "EKMEKÃ‡Ä°", m: "ekmek yapan veya satan kiÅŸi."},
{a: "FENERBOL", m: "hayali oyun veya spor adÄ±."},
{a: "GÄ°ZEM", m: "anlaÅŸÄ±lmayan ÅŸey."},
{a: "HÄ°LE", m: "aldatma veya dÃ¼zenbazlÄ±k."},
{a: "IÅžIK", m: "gÃ¶rmeyi saÄŸlayan enerji."},
{a: "Ä°LAÃ‡", m: "hastalÄ±k iÃ§in kullanÄ±lan madde."},
{a: "JAPON", m: "japonya halkÄ± veya kÃ¼ltÃ¼rÃ¼."},
{a: "KARTON", m: "kalÄ±n kaÄŸÄ±t tÃ¼rÃ¼."},
{a: "LAMBADER", m: "ayakta duran lamba."},
{a: "MANYETÄ°K", m: "Ã§eken veya iten Ã¶zellik."},
{a: "NAKÄ°T", m: "para tÃ¼rÃ¼."},
{a: "OKYANUS", m: "Ã§ok bÃ¼yÃ¼k tuzlu su kÃ¼tlesi."},
{a: "PANTOLON", m: "alt giysi."},
{a: "RAF", m: "eÅŸya koymak iÃ§in dÃ¼z alan."},
{a: "SARKAÃ‡", m: "hareket eden aÄŸÄ±rlÄ±k."},
{a: "TÃœNEL", m: "yer altÄ±ndan geÃ§en yol."},
{a: "ÃœNÄ°VERSÄ°TE", m: "yÃ¼ksek Ã¶ÄŸrenim kurumu."},
{a: "VALÄ°Z", m: "eÅŸya taÅŸÄ±maya yarayan Ã§anta."},
{a: "YELKEN", m: "rÃ¼zgarla ilerleyen taÅŸÄ±t parÃ§asÄ±."},
{a: "ZAMBAK", m: "Ã§iÃ§ek tÃ¼rÃ¼."},
{a: "ALFABE", m: "harflerin belirli sÄ±ralamasÄ±."},
{a: "BÄ°SÄ°KLETÃ‡Ä°", m: "bisiklet kullanan kiÅŸi."},
{a: "Ã‡Ä°MENTO", m: "yapÄ±larda kullanÄ±lan malzeme."},
{a: "DÄ°KÄ°Åž", m: "ip ile yapÄ±lan birleÅŸtirme."},
{a: "EVREN", m: "var olan her ÅŸey."},
{a: "FOTOGRAF", m: "resim veya gÃ¶rÃ¼ntÃ¼ kaydÄ±."},
{a: "GÃœL", m: "Ã§iÃ§ek tÃ¼rÃ¼."},
{a: "HASTANE", m: "tedavi edilen yer."},
{a: "IÅžIKLI", m: "Ä±ÅŸÄ±k saÃ§an."},
{a: "Ä°STASYON", m: "taÅŸÄ±tlarÄ±n durduÄŸu yer."},
{a: "JEST", m: "hareketle anlatÄ±m."},
{a: "KASA", m: "eÅŸya veya para koyulan kutu."},
{a: "LÄ°MONATA", m: "limonla yapÄ±lan iÃ§ecek."},
{a: "MAKAS", m: "kesmek iÃ§in kullanÄ±lan araÃ§."},
{a: "MÄ°NARE", m: "camilerin kule benzeri yapÄ±sÄ±."},
{a: "NAKKAÅž", m: "resim veya sÃ¼sleme yapan kiÅŸi."},
{a: "OKULCU", m: "okulda gÃ¶rev yapan veya Ã¶ÄŸrenci."},
{a: "PÄ°RE", m: "kÃ¼Ã§Ã¼k kan emici bÃ¶cek."},
{a: "RAFÄ°NE", m: "arÄ±tÄ±lmÄ±ÅŸ veya iÅŸlenmiÅŸ."},
{a: "SALATALIK", m: "sebze tÃ¼rÃ¼."},
{a: "TÄ°YATRO", m: "sahne Ã¼zerinde gÃ¶steri yapÄ±lan yer."},
{a: "ÃœZÃœM", m: "kÃ¼Ã§Ã¼k yuvarlak meyve."},
{a: "VÄ°TRÄ°N", m: "sergi veya satÄ±ÅŸ iÃ§in camlÄ± yer."},
{a: "YANGIN", m: "kontrolsÃ¼z ateÅŸ durumu."},
{a: "ZÄ°YADE", m: "fazlalÄ±k veya Ã§okluk."},
{a: "AKORDÄ°YON", m: "mÃ¼zik Ã§almak iÃ§in kullanÄ±lan enstrÃ¼man."},
{a: "BALÄ°NA", m: "bÃ¼yÃ¼k deniz memelisi."},
{a: "Ã‡Ä°NKO", m: "metallerden biri."},
{a: "DÄ°NOZOR", m: "Ã§ok eski Ã§aÄŸlarda yaÅŸamÄ±ÅŸ dev hayvan."},
{a: "ELMA", m: "yemeye uygun meyve."},
{a: "FOSFOR", m: "Ä±ÅŸÄ±k saÃ§an kimyasal madde."},
{a: "GÃ–RÃœNÃœM", m: "dÄ±ÅŸ gÃ¶rÃ¼nÃ¼ÅŸ."},
{a: "HÄ°LE", m: "aldatma veya dÃ¼zenbazlÄ±k."},
{a: "Ä°STÄ°ASYON", m: "taÅŸÄ±tlarÄ±n durduÄŸu yer."},
{a: "JAZZ", m: "mÃ¼zik tÃ¼rÃ¼."},
{a: "KARTAL", m: "bÃ¼yÃ¼k yÄ±rtÄ±cÄ± kuÅŸ."},
{a: "LAVABO", m: "el veya yÃ¼z yÄ±kanan yer."},
{a: "MANDAL", m: "eÅŸya tutucu."},
{a: "MÃœZÄ°K", m: "sesle yapÄ±lan sanat."},
{a: "NAKÄ°T", m: "para tÃ¼rÃ¼."},
{a: "OCAK", m: "yemek piÅŸirme aracÄ±."},
{a: "PALET", m: "taÅŸÄ±ma veya resim yapma aracÄ±."},
{a: "RAF", m: "eÅŸya koymak iÃ§in dÃ¼z alan."},
{a: "SALON", m: "oturma veya etkinlik odasÄ±."},
{a: "TÃœP", m: "gaz veya sÄ±vÄ± saklama kabÄ±."},
{a: "ÃœNÄ°VERSÄ°TE", m: "yÃ¼ksek Ã¶ÄŸrenim kurumu."},
{a: "VALÄ°Z", m: "eÅŸya taÅŸÄ±maya yarayan Ã§anta."},
{a: "YELKENCÄ°", m: "yelkenli ile gezen kiÅŸi."},
{a: "ZAMBAK", m: "Ã§iÃ§ek tÃ¼rÃ¼."},
{a: "Ã‡Ã–L", m: "az yaÄŸÄ±ÅŸ alan kurak alan."},
{a: "TELEFERÄ°K", m: "ip Ã¼zerinde hareket eden araÃ§."},
{a: "Ã‡ERÃ‡EVE", m: "resim veya fotoÄŸrafÄ± Ã§evreleyen yapÄ±."},
{a: "KAZ", m: "suda yaÅŸayan kuÅŸ tÃ¼rÃ¼."},
{a: "KUM", m: "ince taneli toprak parÃ§asÄ±."},
{a: "TAVLA", m: "masa oyunu tÃ¼rÃ¼."},
{a: "KURABÄ°YE", m: "tatlÄ± hamur yiyeceÄŸi."},
{a: "Ã‡Ã–REK", m: "hamurdan yapÄ±lan yiyecek."},
{a: "PATEN", m: "tekerlekli ayakkabÄ± ile kayma aracÄ±."},
{a: "MINÄ°BÃœS", m: "kÃ¼Ã§Ã¼k toplu taÅŸÄ±ma aracÄ±."},
{a: "KÃœLAH", m: "dondurma veya baÅŸa takÄ±lan giysi."},
{a: "BLOKNOT", m: "yazÄ± yazma defteri."},
{a: "TEKERLEK", m: "taÅŸÄ±tlarda kullanÄ±lan yuvarlak parÃ§a."},
{a: "HAVLU", m: "kurulama iÃ§in kullanÄ±lan bez."},
{a: "KÃœPE", m: "kulak sÃ¼sÃ¼."},
{a: "KAZAN", m: "yemek veya sÄ±vÄ± piÅŸirme kabÄ±."},
{a: "KUMPAS", m: "Ã§izim veya Ã¶lÃ§Ã¼m aracÄ±."},
{a: "PERDE", m: "Ä±ÅŸÄ±k veya gÃ¶rÃ¼ÅŸÃ¼ engelleyen giysi veya eÅŸya."}
    ];
    
    let myId = "U_" + Math.floor(Math.random()*999), roomCode = "", gameMode = "normal";
    let currentLevel = parseInt(localStorage.getItem('wz_lvl')) || 0, coins = parseInt(localStorage.getItem('wz_coin')) || 20;
    let guess = [], musicPlayed = false;

    // Otomatik MÃ¼zik ve Focus
    function startMusic() { 
        if(!musicPlayed) { document.getElementById('bg-music').play(); musicPlayed = true; } 
        document.getElementById('hidden-input').focus(); 
    }

    function updateBG() {
        let idx = Math.floor(currentLevel / 10);
        if(idx >= bgImages.length) idx = bgImages.length - 1;
        document.getElementById('bg').style.backgroundImage = `url('${bgImages[idx]}')`;
    }

    // Mod BaÅŸlatÄ±cÄ±
    function initMode(m) {
        gameMode = m; updateBG();
        document.getElementById('menu-screen').style.display = 'none';
        document.getElementById('game-screen').style.display = 'flex';
        loadWord();
    }

    function showLobby() { document.getElementById('menu-screen').style.display = 'none'; document.getElementById('lobby-screen').style.display = 'flex'; }

    // Oda Ä°ÅŸlemleri
    function createRoom() {
        roomCode = Math.floor(1000 + Math.random()*8999).toString();
        db.ref('rooms/'+roomCode).set({ p1: myId, p2: "", status: "waiting", p1P: 0, p2P: 0, wIdx: Math.floor(Math.random()*library.length) });
        setupLobbyUI(); listenRoom();
    }

    function joinRoom() {
        roomCode = document.getElementById('join-input').value;
        db.ref('rooms/'+roomCode).once('value', s => {
            if(s.exists() && s.val().p2 === "") { 
                db.ref('rooms/'+roomCode).update({ p2: myId, status: "ready" }); 
                setupLobbyUI(); listenRoom(); 
            } else { alert("Hata!"); }
        });
    }

    function setupLobbyUI() { 
        document.getElementById('lobby-init').style.display='none'; 
        document.getElementById('lobby-wait').style.display='block'; 
        document.getElementById('room-display').innerText=roomCode; 
    }

    function listenRoom() {
        db.ref('rooms/'+roomCode).on('value', s => {
            const d = s.val(); if(!d) return;
            if(d.p2) document.getElementById('room-status').innerText = "Rakip geldi! HazÄ±r.";
            if(d.p1 === myId && d.p2) document.getElementById('start-btn').style.display = 'block';
            if(d.status === "playing") {
                gameMode = "1v1"; document.getElementById('lobby-screen').style.display = 'none';
                document.getElementById('game-screen').style.display = 'flex';
                document.getElementById('rival-ui').style.display = 'block';
                let rP = (d.p1 === myId) ? d.p2P : d.p1P;
                document.getElementById('rival-fill').style.width = rP + "%";
                if(rP >= 100) { alert("RAKÄ°P KAZANDI!"); location.reload(); }
                if(!guess.length) loadWord(d.wIdx);
            }
        });
    }

    function triggerStart() { db.ref('rooms/'+roomCode).update({ status: "playing" }); }

    // Oyun MantÄ±ÄŸÄ±
    function loadWord(idx = null) {
        let data = library[(idx !== null ? idx : currentLevel) % library.length];
        const area = document.getElementById('word-area'); area.innerHTML = "";
        guess = new Array(data.a.length).fill(null);
        data.a.split('').forEach(() => { 
            let b = document.createElement('div'); b.className = 'letter-box'; area.appendChild(b); 
        });
        document.getElementById('lvl-txt').innerText = currentLevel + 1;
        document.getElementById('coin-txt').innerText = coins;
        document.getElementById('meaning').innerText = "";
        document.getElementById('next-btn').style.display = "none";
    }

    document.getElementById('hidden-input').oninput = (e) => {
        let char = e.target.value.slice(-1).toUpperCase().replace('i','Ä°').replace('Ä±','I');
        let idx = guess.indexOf(null);
        if(idx !== -1 && /[A-ZÃ‡ÄžÄ°Ã–ÅžÃœ]/.test(char)) {
            guess[idx] = char; document.getElementsByClassName('letter-box')[idx].innerText = char;
            let p = (guess.filter(x=>x).length / guess.length) * 100;
            if(gameMode === "1v1") {
                db.ref('rooms/'+roomCode).once('value', s => {
                    if(s.val().p1 === myId) db.ref('rooms/'+roomCode).update({p1P: p});
                    else db.ref('rooms/'+roomCode).update({p2P: p});
                });
            }
            if(!guess.includes(null)) check();
        }
        e.target.value = "";
    };

    function check() {
        let data = library[(gameMode === "1v1" ? 0 : currentLevel) % library.length];
        if(guess.join('') === data.a) {
            document.getElementById('meaning').innerText = data.m;
            if(gameMode === "normal") { 
                coins += 5; currentLevel++; 
                localStorage.setItem('wz_lvl', currentLevel); localStorage.setItem('wz_coin', coins);
                document.getElementById('next-btn').style.display = "block";
            } else { alert("KAZANDIN!"); location.reload(); }
        } else { 
            setTimeout(() => {
                Array.from(document.getElementsByClassName('letter-box')).forEach(b => b.innerText = "");
                guess.fill(null);
            }, 800);
        }
    }

    function nextLevel() { updateBG(); loadWord(); }

    // Splash'Ä± Kesin Kapatan Mekanizma
    window.onload = () => {
        setTimeout(() => {
            const spl = document.getElementById('splash');
            spl.style.transition = "opacity 0.8s";
            spl.style.opacity = '0';
            setTimeout(() => { 
                spl.style.display = 'none'; 
                document.getElementById('menu-screen').style.display = 'flex';
                updateBG();
            }, 800);
        }, 3000);
    };
</script>
</body>
</html>
